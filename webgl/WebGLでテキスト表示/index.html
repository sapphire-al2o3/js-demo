<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>WebGLでテキスト表示 - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/sapphire_al2o3/font -->
<!-- Copyright sapphire_al2o3 - http://jsdo.it/sapphire_al2o3 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<canvas id="canvas" width="200" height="100"></canvas>
<script>
window.onload = function() {
    'use strict';
    var gl = initContext('canvas');
    Font.create(gl, 16);
    
    var timer;
    
    gl.disable(gl.DEPTH_TEST);
    gl.enable(gl.BLEND);
    gl.blendEquation(gl.FUNC_ADD);
    gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ZERO, gl.ONE);
    
    // テクスチャの読み込み
    var img = new Image();
    img.onload = function(e) {
        Font.shader();
        Font.texture(this);
        timer = setAnimationFrame(render, 1000 / 30);
    };
    img.src = 'http://jsrun.it/assets/g/m/U/c/gmUcA.png';
    
    // フォント設定の読み込み
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if(xhr.readyState === 4) {
            var json = JSON.parse(xhr.responseText);
            Font.font(json);
        }
    };
    xhr.open('get', 'http://jsrun.it/assets/s/9/4/h/s94hO');
    xhr.send();
    
    var frame = 0,
        start = Date.now();
    
    function render() {
        gl.clearColor(0.4, 0.7, 0.9, 1.0);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
        var t = (Date.now() - start) / 1000;
        Font.drawText('WebGL', -70, 10);
        Font.drawText(t.toFixed(1), -100, -30);
        Font.draw();
        
        frame++;
        
        gl.flush();
    }
};
</script>

<script type="text/javascript" src="http://jsdo.it/sapphire_al2o3/webglutil/js"></script>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
