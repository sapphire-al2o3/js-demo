<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>WebGLでマンデルブロ集合 - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/sapphire_al2o3/44EZ -->
<!-- Copyright sapphire_al2o3 - http://jsdo.it/sapphire_al2o3 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<canvas id="canvas" width="300" height="300"></canvas>
<div class="frame">
<div class="check" id="size0" style="float: left;"><span></span><p class="label">200x200</p></div>
<div class="check" id="size1" style="float: left; margin-left: 72px;"><span></span><p class="label">300x300</p></div>
<div class="check" id="size2" style="float: left; margin-left: 72px;"><span></span><p class="label">400x400</p></div>
</div>
<script id="shader-fs" type="x-shader/x-fragment">
#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D uSampler;
uniform float uBlock;
varying vec4 vColor;

void main() {
  vec4 pos = vColor;
  float n = 0.0;
  float zx = 0.0;
  float zy = 0.0;
  float zx2 = 0.0;
  float zy2 = 0.0;
  float t;
  float step = 1.0 / 128.0;
  int i = 0;
  for(int i = 0; i < 128; i++) {
  //while(true) {
    t = zx * zx - zy * zy + pos.x;
    zy = 2.0 * zx * zy + pos.y;
    zx = t;
  //zx2 = zx * zx;
  //zy2 = zy * zy;
    //if(zx * zx2 + zy2 > 4.0) {
    if(zx * zx + zy * zy > 4.0) {
      //n = 0.999;
      break;
    }
    n += step;
  }
  vec4 color;
  /*
  color.x = n;
  color.y = clamp(n * 8.0, 0.0, 1.0);
  color.z = clamp(n * 16.0, 0.0, 1.0);
  color.w = 1.0;
  */
  color = texture2D(uSampler, vec2(n, 0.0));
  gl_FragColor = color;
}
</script>
<script id="shader-vs" type="x-shader/x-vertex">
attribute vec3 aVertexPosition;

varying vec4 vColor;
uniform vec2 uOffset;
uniform float uBlock;

void main() {
  gl_Position = vec4(aVertexPosition, 1);
  vColor = gl_Position;
  vColor.x -= 0.5;
  vColor *= uBlock;
  vColor += vec4(uOffset, 0.0, 0.0);
}
</script>



<script type="text/javascript" src="index.js"></script>
</body>
</html>
