<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>WebGLで花火 - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/sapphire_al2o3/fjsA -->
<!-- Copyright sapphire_al2o3 - http://jsdo.it/sapphire_al2o3 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<script id="shader-vs-fill" type="x-shader/x-vertex">
	attribute vec2 position;

	void main() {
		gl_Position = vec4(position.xy, 1.0, 1.0);
	}
</script>
<script id="shader-fs-fill" type="x-shader/x-fragment">
	precision mediump float;

	uniform vec4 color;

	void main() {
		gl_FragColor = color;
	}
</script>
<script id="shader-vs" type="x-shader/x-vertex">

	attribute vec3 position;
	
	varying vec4 vertexColor;

	uniform mat4 pMatrix;
	uniform mat4 mvMatrix;
	uniform vec4 color;

	void main() {
		gl_Position = pMatrix * mvMatrix * vec4(position, 1.0);
		float a = 1.0;
		vertexColor = vec4(color.rgb, a);
	}
</script>
<script id="fireworks-vs" type="x-shader/x-vertex">

	attribute vec3 v;
	
	varying vec4 vertexColor;

	uniform mat4 pMatrix;
	uniform mat4 mvMatrix;
	uniform vec4 color;
	uniform vec3 position;
	uniform float scale;
	uniform float time;
	uniform float speed;
	uniform vec3 g;

	void main() {
		vec3 p = position + v * speed * time + 0.5 * g * time * time;
		gl_Position = pMatrix * mvMatrix * vec4(p, 1.0);
		gl_PointSize = scale / gl_Position.w;
		float a = smoothstep(0.0, 0.6, 1.0 - time);
		vertexColor = vec4(color.rgb, a);
	}
</script>
<script id="shader-fs" type="x-shader/x-fragment">
	precision mediump float;
	
	varying vec4 vertexColor;
	
	void main() {
		
		gl_FragColor = vertexColor;
	}
</script>
<script id="tail-vs" type="x-shader/x-vertex">

	attribute float o;
	
	varying vec4 vertexColor;

	uniform mat4 pMatrix;
	uniform mat4 mvMatrix;
	uniform vec4 color;
	uniform vec3 position;
	uniform float scale;
	uniform float time;
	uniform float speed;
	uniform vec3 velocity;
	uniform vec3 g;

	void main() {
		float t = time - o;
		vec3 p = position + velocity * t + 0.5 * g * t * t;
		//p.x += cos(t * 16.0) * 0.1;
		//p.z += sin(t * 32.0) * 0.1;
		gl_Position = pMatrix * mvMatrix * vec4(p, 1.0);
		float s = scale - o * 100.0;
		gl_PointSize = s / gl_Position.w;
		float a = smoothstep(0.0, 0.6, time);
		a = clamp(0.0, 1.0, a - o * 10.0);
		vertexColor = vec4(color.rgb, a);
	}
</script>
<canvas id="canvas" width="400" height="400"></canvas>


<script type="text/javascript" src="../../lib/webglutil.js"></script>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
